---
title: "Анализ данных mtcars"
author: "Бочарникова Анастасия"
date: "2025-11-18"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(knitr)
```

1. **Отбор и фильтрация данных**
Выбраны столбцы: mpg, cyl, hp, wt, am.
Отфильтрованы строки, где количество цилиндров (cyl) равно 6 или 8, а мощность (hp) больше 100.
```{r filter}
filtered_data <- mtcars %>% 
  select(mpg, cyl, hp, wt, am) %>% 
  filter(cyl %in% c(6, 8), hp > 100)
```

Количество автомобилей после фильтрации: `r nrow(filtered_data)`

2. **Создание новых переменных**
Добавлены два новых столбца:
hp_per_wt: отношение мощности (hp) к весу (wt).
category: категория автомобиля на основе расхода топлива (mpg).
```{r transform}
transformed_data <- filtered_data %>% 
  mutate(
    hp_per_wt = hp / wt,
    category = case_when(
      mpg < 18 ~ "low",
      mpg >= 18 & mpg <= 22 ~ "medium",
      mpg > 22 ~ "high"
    )
  )
```

3. **Группировка и агрегация**
Данные сгруппированы по столбцам cyl и category. Для каждой группы посчитаны:
Среднее значение мощности (hp).
Минимальное и максимальное значение веса (wt).
Количество наблюдений в группе.
```{r results}
result <- transformed_data %>% 
  group_by(cyl, category) %>% 
  summarise(
    mean_hp = mean(hp),
    min_wt = min(wt),
    max_wt = max(wt),
    count = n(),
    .groups = 'drop'
  ) %>% 
  arrange(desc(mean_hp))
```

4. **Результаты**

Итоговая таблица после всех преобразований:
```{r print-table}
kable(result)
```

---

**Выводы:**

Всего в анализе использовано `r nrow(transformed_data)` автомобилей после фильтрации.

Наибольшая средняя мощность (`r round(max(result$mean_hp), 1)` л.с.) наблюдается в группе с `r result$cyl[which.max(result$mean_hp)]` цилиндрами и категорией `r result$category[which.max(result$mean_hp)]`.